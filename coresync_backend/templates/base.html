<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>{% block title %}CORESYNC{% endblock %}</title>
    
    <!-- Critical Menu State Restoration -->
    <!-- Executes BEFORE DOM/CSS load to prevent flash -->
    <!-- Exception to §0.2: Critical path optimization for UX -->
    <script>
        (function() {
            if (localStorage.getItem('coresync_menu_open') === 'true') {
                document.documentElement.classList.add('coresync-menu-restore');
            }
        })();
    </script>
    
    <!-- Critical CSS for instant menu restoration -->
    <!-- Exception to §0.3: One documented !important for critical path -->
    <style>
        /* Critical path optimization - instant menu state restoration */
        /* Prevents flash of closed menu on page load when menu should be open */
        /* Reference: Menu persistence feature - localStorage implementation */
        
        /* Burger menu → X transformation */
        html.coresync-menu-restore #burger-menu .burger-line:nth-child(1) {
            transform: rotate(45deg) translate(6px, 6px);
        }
        
        html.coresync-menu-restore #burger-menu .burger-line:nth-child(2) {
            opacity: 0;
        }
        
        html.coresync-menu-restore #burger-menu .burger-line:nth-child(3) {
            transform: rotate(-45deg) translate(6px, -6px);
        }
        
        /* Logo shrink */
        html.coresync-menu-restore .header-logo-img {
            height: 30px;
        }
        
        /* Menu visible */
        html.coresync-menu-restore #nav-menu {
            opacity: 1;
            visibility: visible;
        }
        
        /* Buttons instantly visible - override default opacity: 0 */
        html.coresync-menu-restore #nav-menu .nav-btn {
            opacity: 1 !important; /* Critical: Override .nav-btn { opacity: 0 } */
            pointer-events: auto;
        }
    </style>
    
    {% load static %}
    <link rel="stylesheet" href="{% static 'css/styles.css' %}">
    {% block extra_css %}{% endblock %}
</head>

<body>
    <!-- Header -->
    <header class="header">
        <div class="container">
            <!-- Logo - centered -->
            <div class="header-logo">
                <a href="{% url 'home' %}">
                    <img src="{% static 'images/menu.png' %}" alt="CORESYNC" class="header-logo-img">
                </a>
            </div>

            <!-- Navigation Menu -->
            <nav class="nav-menu" id="nav-menu">
                <div class="nav-left">
                    <button class="nav-btn" data-link="{% url 'membership' %}">Membership</button>
                    <button class="nav-btn" data-link="{% url 'contacts' %}">Contacts</button>
                    {% if user.is_authenticated %}
                    <button class="nav-btn" data-link="/dashboard/">My Account</button>
                    {% else %}
                    <button class="nav-btn" data-link="/signup/">Sign Up</button>
                    <button class="nav-btn" data-link="/login/">Sign In</button>
                    {% endif %}
                </div>
                
                <div class="nav-spacer"></div>
                
                <div class="nav-right">
                    <button class="nav-btn" data-link="{% url 'menssuite' %}">Mensuite</button>
                    <button class="nav-btn" data-link="{% url 'private' %}">Coresync Private</button>
                    <button class="nav-btn nav-btn--book" data-link="{% url 'booking_calendar' %}">BOOK NOW</button>
                </div>
            </nav>

            <div class="burger-menu" id="burger-menu">
                <span class="burger-line"></span>
                <span class="burger-line"></span>
                <span class="burger-line"></span>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main>
        {% block content %}
        {% endblock %}
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-address">
                    1544 71ST STREET<br>
                    BROOKLYN, NY 11228
                </div>
                <div class="footer-logo">
                    <img src="{% static 'images/footerlogo.png' %}" alt="CoreSync" class="footer-logo-img">
                </div>
                <div class="footer-contact">
                    551.574.2281<br>
                    INFO@CORESYNC.LIFE
                </div>
            </div>
            <div class="footer-cta">
                <button class="footer-btn">
                    NEED ANYTHING? WE'RE HERE.
                </button>
            </div>
        </div>
    </footer>

    <script src="{% static 'js/script.js' %}"></script>
    {% block extra_js %}{% endblock %}
</body>

</html>